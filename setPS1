#!/bin/env bash

BASE=/home/Ending
rcfile=/cygdrive/c/Users/Ending/.qyh_vim/vimrc
export PROXY_HOST=localhost
PROXY_PORT=2333
export TIME_STYLE=+"%Y.%m.%d %H:%M:%S"
export HISTFILESIZE=
export HISTSIZE=
export HISTTIMEFORMAT="[%F %T] "
export HISTFILE=~/.bash_history_qyh
PROMPT_COMMAND="history -a; $PROMPT_COMMAND"

main( ) {
    show_banner
    set_working_dir "$@"
    set_PS1
    set_proxy
    clean_proxy
    set_PATH
    stty -ixon
    export LS_COLORS=`cat $BASE/tools/_LS_COLORS_`
}

set_working_dir( ) {
    export desktop=/cygdrive/c/Users/Ending/Desktop
    export wv=/cygdrive/c/Users/Ending/.qyh_vim
    export ws=/cygdrive/e/Source
    export wn=/cygdrive/e/Stay/txt_and_more/notes
    export wp=/cygdrive/e/pdf
    export wcc=/cygdrive/d/binary/cmder/config
}

set_PS1( ) {
    # PS1="\[\e]0;\w\a\]\[\e[32m\]\u@\h \[\e[33m\]\w\[\e[0m\]\n\$ "
    PS1='${debian_chroot:+($debian_chroot)}\[\033[01;31m\]\u@\h\[\033[00m\]:\[\033[01;34m\]\w\[\033[00m\]\$ '
}

set_proxy( ) {
    export http_proxy=$PROXY_HOST:$PROXY_PORT
    export https_proxy=$PROXY_HOST:$PROXY_PORT
}

clean_proxy( ) {
    export http_proxy=
    export https_proxy=
}


set_PATH( ) {
    export PATH=$PATH:$BASE/tools
    if [ -z "$PYTHON_HOME" ] ; then
        echo "[-] Need to set PYTHON_HOME"
        return
    fi
    target=$PYTHON_HOME
    target=$(echo $target | sed -e 's/\\/\//g' | sed -e 's/://g')
    target='/cygdrive/'$target':'
    target=$(echo $target | sed -e 's/\//\\\//g')
    path_=$(echo $PATH | sed "s/$target//Ig")
    target=$PYTHON_HOME
    target=$(echo $target | sed -e 's/\\/\//g' | sed -e 's/://g')
    target='/cygdrive/'$target'/scripts:'
    target=$(echo $target | sed -e 's/\//\\\//g')
    path_=$(echo $path_ | sed "s/$target//Ig")
    export PATH=$path_
}

show_banner( ) {
    clear
    cat $BASE/tools/banner.txt
}

vim_( ) {
    vim -u "$rcfile" "$@"
}

git( ){
    /usr/bin/git.exe "$@"
}

main "$@"

alias ls="ls -N -h -F --color=auto --show-control-chars"
alias ll="ls -N -h -F -l --color=auto --show-control-chars"
alias du="du -h --time --max-depth=1"
alias gl="git log --oneline --all --graph --decorate"
alias e.="explorer ."
alias gt="git status --short --branch"
